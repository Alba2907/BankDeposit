{"version":3,"file":"js/730.af3366f8.js","mappings":"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","sources":["webpack://vue-practice-app/./src/views/Auth.vue","webpack://vue-practice-app/./src/use/login-form.js","webpack://vue-practice-app/./src/views/Auth.vue?30a9"],"sourcesContent":["<template>\r\n<form class=\"card\" @submit.prevent=\"onSubmit\">\r\n  <h1>Войти в систему</h1>\r\n  \r\n  <div :class=\"['form-control', {invalid: eError}]\">\r\n    <label for=\"email\">Email</label>\r\n    <input type=\"email\" id=\"email\" v-model=\"email\">\r\n    <small v-if=\"eError\">{{ eError }}</small>\r\n  </div>\r\n\r\n<!--  данная запись присваивает класс форм контрол всегда, и добавляет класс инвалид, если пЕррор тру-->\r\n  <div :class=\"['form-control', {invalid: pError}]\">\r\n    <label for=\"password\">password</label>\r\n    <input type=\"password\" id=\"password\" v-model=\"password\">\r\n    <small v-if=\"pError\">{{ pError }}</small>\r\n  </div>\r\n<!--отключаем кнопку пока сабмититься форма или если много попыток-->\r\n<button class=\"btn primary\" type=\"submit\" :disabled=\"isSubmitting || isMany\">Войти</button>\r\n  <div class=\"text-danger\" v-if=\"isMany\">Вы слишком часто пытаетесь войти в систему. Попробуйте позже</div>\r\n\r\n</form>\r\n</template>\r\n\r\n<script>\r\nimport {useLoginForm} from \"@/use/login-form\";\r\nimport {useRoute} from \"vue-router\";\r\nimport {useStore} from \"vuex\";\r\nimport {error} from \"@/utils/error\";\r\n\r\n\r\n\r\n\r\nexport default {\r\n  setup() {\r\n\r\n    const store = useStore()\r\n\r\n    const route = useRoute()\r\n\r\n    if (route.query.message) {\r\n      store.dispatch('setMessage', {\r\n        value: error(route.query.message),\r\n        type: 'warning'\r\n      })\r\n\r\n    }\r\n\r\n    // мы вынесли всю логику в отдельный файл, а сюда просто импортируем его\r\n    return {...useLoginForm()}\r\n\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>","\r\n// для набора валидаторов\r\n\r\nimport {useField, useForm} from \"vee-validate\";\r\nimport * as yup from \"yup\";\r\nimport {computed, watch} from \"vue\";\r\nimport {useStore} from \"vuex\";\r\nimport {useRouter} from \"vue-router\";\r\n\r\nexport function useLoginForm() {\r\n\r\n    const store = useStore()\r\n\r\n    const router = useRouter()\r\n\r\n    const {handleSubmit, isSubmitting, submitCount} = useForm()\r\n\r\n    // мы меняем имена для получаемых параметров, чтобы они были уникальны\r\n    const {value: email, errorMessage: eError, handleBlur: eBlur} = useField(\r\n        'email',\r\n        yup\r\n            .string()\r\n            .trim()\r\n            .required('Пожалуйста введите email')\r\n            .email('Необходимо ввести корректный email')\r\n    )\r\n\r\n    const PAS_MIN = 6\r\n\r\n    const {value: password, errorMessage: pError, handleBlur: pBlur} = useField('password',\r\n        yup\r\n            .string()\r\n            .trim()\r\n            .required('Пожалуйста введите пароль')\r\n            .min(PAS_MIN, `Пароль не может быть короче ${PAS_MIN} символов  `)\r\n    )\r\n\r\n    //    делаем не более трех нажатий войти\r\n    const isMany = computed(() => submitCount.value >= 3)\r\n\r\n    //  следим за тем тру или фолс значение из мани, и если да, то запускаем таймер, чтрбы поменять его\r\n    watch(isMany, val => {\r\n        if(val) {\r\n            setTimeout(() => submitCount.value = 0,1500)\r\n        }})\r\n    // делаем трай кетч чтобы в случае не удачи не делать никаких переходов\r\n    const onSubmit = handleSubmit( async values => {\r\n        try {\r\n        // получаем метод из модуля стора, по сути это процесс логина, после котрого мы переходим на главную\r\n        await store.dispatch('auth/login', values)\r\n        router.push('/')\r\n            } catch (e) {\r\n\r\n}\r\n    })\r\n\r\n    return {\r\n\r\n        eError, email, eBlur, password, pError, pBlur, onSubmit, isSubmitting, isMany\r\n\r\n    }\r\n\r\n}","import { render } from \"./Auth.vue?vue&type=template&id=50e72ab6\"\nimport script from \"./Auth.vue?vue&type=script&lang=js\"\nexport * from \"./Auth.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"F:\\\\Study JS, HTML, CSS\\\\vuejs\\\\portfolioProjexts\\\\bank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementVNode","for","class","_createElementBlock","onSubmit","_ctx","_hoisted_1","_normalizeClass","invalid","_hoisted_2","type","id","$event","_hoisted_3","_toDisplayString","_hoisted_4","_hoisted_5","disabled","_hoisted_6","useLoginForm","store","useStore","router","useRouter","useForm","handleSubmit","isSubmitting","submitCount","useField","yup","trim","required","email","value","eError","errorMessage","eBlur","handleBlur","PAS_MIN","min","password","pError","pBlur","isMany","computed","watch","val","setTimeout","values","dispatch","push","setup","route","useRoute","query","message","error","__exports__","render"],"sourceRoot":""}